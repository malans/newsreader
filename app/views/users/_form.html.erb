<% action_url = user.persisted? ? user_url(user) : users_url %>
<% http_method = user.persisted? ? "PATCH" : "POST" %>
<% button_text = user.persisted? ? "Update User" : "Sign Up" %>

<form action="<%= action_url %>" method="post">
  <%= auth_token %>
  <input type="hidden" name="_method" value="<%= http_method %>">

  <label>Username
  <input type="text" name="user[username]" value="<%= @user.username %>">
  </label>

  <label>Password
  <input type="password" name="user[password]">
  </label>

  <input type="submit" value="<%= button_text %>">
</form>
